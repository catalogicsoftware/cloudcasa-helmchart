apiVersion: v1
kind: Pod
metadata:
  name: "cloudcasa-test-agent"
  namespace: cloudcasa-io
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: kubeagentmanager-test
      image: catalogicsoftware/amds-kagent:3.1.0-prod
      command: ["bin/bash", "-c"]
      args:
        - kubectl get deployment cloudcasa-kubeagent-manager
        - -o=jsonpath='{.status.conditions[?(@.type=="Available")].status}' |
        - grep -q "True"
  serviceAccountName: cloudcasa-io
  restartPolicy: Never
